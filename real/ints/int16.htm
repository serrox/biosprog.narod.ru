<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Низкоуровневое програмирование</title>
	<meta name="keywords" content="программирование BIOS INT INT16 реальный режим ассемблер 16bit клавиатура" />
	<meta name="description" content="Низкоуровневое программирование: Прерывания БИОС: INT 16" />
</head>
<body>
	<a href=../../index.htm>Главная</a> - <a href=../index.htm> Реальный режим </a> - <a href=int.htm>Прерывания Bios</a> - <b>INT 16h: Ввод/вывод клавиатуры.</b><br />
	<h2>INT 16h: Ввод/вывод клавиатуры.</h2>
<table border=1 width=100%><tr><td>AH</td><td> &nbsp;</td></tr>
<tr><td valign=top>0h</td><td>Читать буфер клавиатуры (84-клавишная клавиатура)<br /><br />
	На выходе: AH - скан-код<br />
		AL - ASCII код<br /><br />
	Ждёт нажатия, если клавиша не нажата, и потом выдаёт нажатую клавишу</td></tr><tr><td valign=top>
1</td><td>Получить состояние клавиатуры (84-клавишная клавиатура)<br /><br />
На выходе: При ZF=1 нет клавиши<br />
При ZF=0:<br />
AH - скан-код<br />
AL - ASCII код</td></tr><tr><td valign=top>
2</td><td> Флаги клавиатуры (84-клавишная клавиатура)<br /><br />
На выходе: AL - флаги (0 -незажата, 1 - зажата(для режмов - включён)):<br />
бит 0 : правый Shift<br />
бит 1 : левый Shift<br />
бит 2 : CTRL<br />
бит 3 : ALT<br />
бит 4 : режим Scroll lock<br />
бит 5 : режим Num Lock<br />
бит 6 : режим Caps Lock<br />
бит 7 : режим Insert</td></tr><tr><td valign=top>
3</td><td>
<table border=1 width=100%><tr><td>
AL</td><td>Функция</td></tr><tr><td valign=top>
05h</td><td> Режим автоповтора<br />
<font color=red>Перед преминением проверьте наличие этой функции с помощью <a href=#9>функции 09</a></font><br />
Вход:<br />
BH - задержка :<br /> 0 - 250мс,<br /> 1- 500,<br /> 2 - 750,<br /> 3 - 1000;<br />
BL -  частота (символов в секунду):<br /> 0 - 30,<br /> 1 - 26.7,<br /> 2 - 24.0,<br /> 3 - 21.8,<br /> 4 - 20.0,<br /> 5 - 18.5,<br /> 6 - 17.1,<br /> 7 - 16.0,<br /> 8 - 15.0,<br /> 9 - 13.3,<br /> A - 12.0,<br /> B - 10.9,<br /> C - 10.0,<br /> D - 9.2,<br /> E - 8.6,<br /> F - 8.0,<br /> 10 - 7.5,<br /> 11 - 6.7,<br />12 - 6.0,<br /> 13 - 5.5,<br /> 14 - 5.0,<br /> 15 - 4.6,<br /> 16 - 4.3,<br /> 17 - 4.0,<br /> 18 - 3.7,<br /> 19 - 3.3,<br /> 1A - 3.0,<br /> 1B - 2.7,<br /> 1C - 2.5,<br /> 1D - 2.3,<br /> 1E - 2.1,<br /> 1F - 2.0.<br />
</td></tr></table>
</td></tr><tr><td valign=top>
4 </td><td> Звук клавиш <br />
На входе: Al==1 - включено, AL==0 - выключено;</td></tr><tr><td valign=top>
5</td><td> Поместить символ в бувер клавиатуры <br />
На входе: CH - скан-код<br />
CL - ASCII код<br />
На выходе: AL == 0 - успех, иначе ошибка, при поставленом флаге переноса - буфер переполнен.</td></tr><tr><td valign=top>
<a name=9>9</a></td><td> Функциональные возможности <br />
<b><font color=red>Поддерживается не всеми BIOS<br/>
Перед пременение реккомендуется проверить подлержку с помошью <a href=int15.htm#c0>функции C0h прерывания 15h</a></font></b><br /><br />
На входе: AL = 0<br />
На выходе: AL (если AL==0, то AH): байт возможностей:<br />
бит 0 : поддержка функции 0300h, int16h<br />
бит 1 : поддержка функции 0304h, int16h<br />
бит 2 : поддержка функции 0305h, int16h<br />
бит 3 : поддержка функции 0306h, int16h<br />
бит 4 : поддержка функции 0Ah, int16h<br />
бит 5 : поддержка клавиатуры 101/102 клавиши<br />
бит 6 : поддержка клавиатуры 122 клавиши<br />
бит 7 : резерв</td></tr><tr><td valign=top>
Ah</td><td> ID клавиатуры <br />
На входе: AL = 0<br />
На выходе: BX : <br />
0 - нет клавиатуры<br />
41ABh - Японская "G" клавиатура в режиме транслита<br />
54ABh - Японская "P" клавиатура в режиме транслита<br />
83ABh - Японская "G" клавиатура в режиме pass-through<br />
84ABh - Японская "P" клавиатура в режиме pass-through<br />
86ABh - 122-х клавишная<br />
90ABh - старая Японская "G" клавиатура<br />
91ABh - старая Японская "P" клавиатура<br />
92ABh - старая Японская "A" клавиатура</td></tr><tr><td valign=top>
<a name=10>10h</a></td><td> Читать буфер клавиатуры (101/102-клавишная клавиатура)<br /><br />
На выходе: Для стандартных клавиш:<br />
AH - расширеный скан-код<br />
AL - ASCII код<br /><br />
Для клавиш и комбинаций с расширеным кодом:<br />
AL = 0<br />
AH - расширеный ASCII код<br /><br />
Для доп. клавиш:
AH - расширеный ASCII код<br />
AL = 0eh<br /><br />
Ждёт нажатия, если клавиша не нажата, и потом выдаёт нажатую клавишу</td></tr><tr><td valign=top>
<a name=11>11h</a></td><td>Получить состояние клавиатуры (101/102-клавишная клавиатура)<br /><br />
На выходе: если ZF==1, то символа нет<br />
если ZF==0<br />
Для стандартных клавиш:<br />
AH - расширеный скан-код<br />
AL - ASCII код<br /><br />
Для клавиш и комбинаций с расширеным кодом:<br />
AL = 0<br />
AH - расширеный ASCII код<br /><br />
Для доп. клавиш:
AH - расширеный ASCII код<br />
AL = 0eh</td></tr><tr><td valign=top>
<a name=12>12h</a></td><td>Флаги Клавиатуры (101/102-клавишная клавиатура)<br /><br />
На выходе: AX - байт флагов(0 -незажата, 1 - зажата(для режмов - включён)):<br />
бит 0 : правый Shift<br />
бит 1 : левый Shift<br />
бит 2 : CTRL<br />
бит 3 : ALT<br />
бит 4 : режим Scroll lock<br />
бит 5 : режим Num Lock<br />
бит 6 : режим Caps Lock<br />
бит 7 : режим Insert<br />
бит 8 : Левый CTRL<br />
бит 9 : Левый ALT<br />
бит 10 : Правый CTRL<br />
бит 11 : Правый ALT<br />
бит 12 : Клавиша Scroll lock<br />
бит 13 : Клавиша Num Lock<br />
бит 14 : Клавиша Caps Lock<br />
бит 15 : Клавиша SysReq</tr></td><tr><td valign=top>
20h</td><td> Аналагично <a href=int16.htm#10>функции 10h, int 16h</a>, но для 122-х клавишной клавиатуры</td></tr><tr><td valign=top>
21h</td><td> Аналагично <a href=int16.htm#11>функции 11h, int 16h</a>, но для 122-х клавишной клавиатуры</td></tr><tr><td valign=top>
22h</td><td> Аналагично <a href=int16.htm#12>функции 12h, int 16h</a>, но для 122-х клавишной клавиатуры</td></tr>
</table>
</body>
</html>